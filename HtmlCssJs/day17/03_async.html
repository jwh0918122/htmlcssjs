<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>async await</title>
</head>

<body>
    <h1>
        비동기 통신(asynchronous communication) : AJAX (ajax)
    </h1>
    <ul>
        <li>
            데이터를 받는 방식(통신) : 동기통신, 비동기통신
        </li>
        <li>
            동기 통신(synchronous) : 동시에 일어난다
            요청을 하면 응답을 바로 받는다는 의미
            (ex :데이터를 한번에 뿌리는 거(이젠 클럽. but 댓글,게시글은 비동기))
        </li>
        <li>
            비동기 통신(asynchronous) : 동시에 일어나지 않는다
            요청을 하면 바로 그자리에서 결과가 주어지지 않을 수도 있다
            (ex: 네이버 증시, 날씨 등 그때그때 다른 데이터값이 나올때(데이터를 따로따로 뿌림))
        </li>
        <li>
            동기방식
            장점: 설계가 간단하고 직관적.
            단점: 결과가 주어지기 전까지는 아무것도 못하고 대기해야 하는 단점이 있음
        </li>
        <li>
            비동기 방식
            단점: 설계가 복잡함.
            장점: 결과가 주어지는데 시간이 걸리더라고 그동안 다른 작업이 가능해서 효율적임
        </li>
    </ul>
    <ul>
        <li>
            async await : Promise 객체를 이용하여 데이터 통신을 편리하게
            해주는 (제공되는)키워드 //(JSON에서 받는 string데이터도 Promise객체형태의 string 데이터임)
        </li>
        <li>
            async 키워드 : 함수 선언 키워드(function) 앞에 사용하며 그 함수의 리턴을
            프로미스 객체 타입으로 만들어준다.
        </li>
        <li>
            await 키워드 : 순차적 코드 실행 시 데이터 통신과 같은 지연 로딩
            또는 지연 실행 같은 상황이 발생되면 코드의 실행 순서를 순차적으로
            진행할 수 있도록 보증한다.
            즉, 이전 라인의 코드 실행이 완료될 때 까지 다음 라인을 기다리도록 하는 기능
        </li>
        <li>
            http://jsonplaceholder.typicode.com/
        </li>
        <li>
            리퀘스트 : 내가 요청한 데이터
            리스폰스 : 리퀘스트에 대한 리스펀스(응답)

        </li>
    </ul>
    <h3>
        async await 연습
    </h3>
    <button type="button" id="btn">데이터 불러오기</button>

    <script>
        document.getElementById('btn').addEventListener('click', () => {
            async function awaitEx() {
                try {
                    const resp = await fetch('https://jsonplaceholder.typicode.com/todos/1'); //경로
                    const result = await resp.text(); //(resp는 response(프로미스라고 생각해도 됨..?) 타입(가져오는 정보가 많아서). body정보만 뽑아서 text로 변환해줌.)
                    console.log(resp);
                    console.log(typeof resp);
                    console.log(result);
                    console.log(typeof result);
                    let j = JSON.parse(result); //JSON의 타입을 string->object로 바꿈
                    console.log('jj')
                    console.log(j);
                    console.log(typeof j);
                    return result;
                } catch (error) {
                    console.log(error);
                } finally {
                    console.log('await finish');
                }

            }


            let text = awaitEx();
            console.log('--text--')
            console.log(text); //프로미스 객체로 리턴 됨(text형식으로 받았어도 리턴해서 함수밖으로 나오면 프로미스 객체로 리턴됨)
            console.log('--typeof text--')
            console.log(typeof text);

        })


    </script>
</body>

</html>